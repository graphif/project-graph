# 实现图片节点拖拽缩放功能

## 1. 实现目标

- 选中图片节点后，在右下角显示缩放控制点
- 拖拽控制点可等比例缩放图片
- 保持现有的等比例缩放特性
- 性能优化：只在选中时显示控制点

## 2. 实现步骤

### 步骤1：让ImageNode实现ResizeAble接口

- 修改`ImageNode.tsx`，让其实现`ResizeAble`接口
- 添加`getResizeHandleRect()`方法，返回右下角缩放控制点矩形
- 添加`resizeHandle()`方法，根据拖拽距离计算新缩放比例

### 步骤2：修改EntityRenderer渲染缩放控制点

- 修改`EntityRenderer.tsx`中的`renderImageNode`方法
- 选中状态下，调用`shapeRenderer.renderRect()`绘制缩放控制点
- 控制点位置：右下角，大小随相机缩放

### 步骤3：确保ControllerEntityResize支持ImageNode

- 检查`ControllerEntityResize.tsx`是否能处理ImageNode
- 确保`utilsControl.tsx`中`isClickedResizeRect`能正确检测ImageNode的缩放控制点

### 步骤4：移除旧的提示文字

- 在`EntityRenderer.tsx`的`renderImageNode`方法中，移除"ctrl+滚轮缩放大小"提示
- 保持Ctrl+滚轮缩放功能不变，增加拖拽缩放作为补充

### 步骤5：性能优化

- 复用现有的渲染逻辑，避免额外性能开销
- 只在节点选中且相机缩放足够大时绘制控制点
- 使用与TextNode相同的缩放控制点样式，保持一致性

## 3. 技术细节

### 缩放控制点设计

- 位置：图片右下角
- 大小：固定像素大小，随相机缩放
- 样式：与TextNode缩放控制点一致
- 颜色：使用`stageStyleManager.currentStyle.CollideBoxSelected`

### 缩放逻辑

- 保持等比例缩放，根据拖拽距离计算新的缩放比例
- 缩放范围：0.1 - 10（与现有逻辑一致）
- 拖拽时实时更新碰撞箱

### 交互流程

1. 选中图片节点
2. 右下角显示缩放控制点
3. 鼠标悬停控制点时，鼠标样式变为缩放样式
4. 拖拽控制点，图片等比例缩放
5. 释放鼠标，完成缩放

## 4. 代码修改点

1. **`ImageNode.tsx`**：实现ResizeAble接口，添加缩放相关方法
2. **`EntityRenderer.tsx`**：渲染缩放控制点，移除旧提示
3. **`ControllerEntityResize.tsx`**：确保支持ImageNode（如果需要）
4. **`utilsControl.tsx`**：确保能检测ImageNode的缩放控制点（如果需要）

## 5. 预期效果

- 选中图片节点后，右下角显示缩放控制点
- 拖拽控制点可流畅地等比例缩放图片
- 保持现有Ctrl+滚轮缩放功能不变
- 性能良好，不影响其他操作
- 与现有UI风格保持一致
