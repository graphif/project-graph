## 问题分析

当文本节点转换为引用块时，如果该文本节点已经有连线连接，这些连线会变成"架空"状态，无法删除。

### 根本原因

1. `changeTextNodeToReferenceBlock` 函数直接调用 `StageManager.delete(selectedNode)` 删除原文本节点
2. `StageManager.delete()` 只是简单地从数组中移除对象，没有处理关联的连线
3. 虽然 `DeleteManager` 有 `deleteEntityAfterClearAssociation` 方法来清理节点删除后的连线，但该方法只在 `DeleteManager.deleteEntities()` 中被调用
4. 转换过程中创建了新的引用块节点，但没有处理原节点的连线关系

## 解决方案

修改 `changeTextNodeToReferenceBlock` 函数，在转换节点时正确处理连线关系：

1. 在删除原文本节点前，获取所有与该节点相关的连线
2. 创建新的引用块节点
3. 将原节点的连线更新为连接到新的引用块节点
4. 最后删除原文本节点

## 实施步骤

1. 查看 `changeTextNodeToReferenceBlock` 函数的完整实现
2. 修改该函数，添加连线处理逻辑
3. 测试修复效果

## 预期结果

- 文本节点转换为引用块时，原节点的连线会自动转移到新的引用块节点
- 不会出现"架空"的连线
- 转换后的引用块节点可以正常与其他节点连接

## 代码修改点

- `/Users/littlefean/Desktop/Projects/project-graph/app/src/core/service/dataManageService/textNodeSmartTools.tsx`：修改 `changeTextNodeToReferenceBlock` 函数

## 具体修改思路

1. 在删除原节点前，遍历所有关联，找出与原节点相关的连线
2. 创建新的引用块节点
3. 更新这些连线的源/目标为新的引用块节点
4. 删除原节点

这样可以确保连线关系被正确转移，不会出现悬空的连线。
